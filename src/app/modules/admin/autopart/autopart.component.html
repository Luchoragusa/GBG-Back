<fuse-alert
    [appearance]="'soft'"
    [dismissible]="true"
    [dismissed]="dismissed"
    [name]="'alertBox1'"
    [type]="'success'">
    Se guardo correctamente el repuesto.
</fuse-alert>

<div class="flex flex-auto">

  <!-- Drawer -->
  <fuse-drawer
  class="w-screen min-w-screen sm:w-100 sm:min-w-100 z-999"
  fixed
  [mode]="'over'"
  [position]="'right'"
  [opened]="drawerOpened"
  #settingsDrawer>

  <!--Sidenav -->

    <form  
      class="flex flex-col flex-auto p-6 pt-10 sm:p-8 sm:pt-10 overflow-y-auto"
      [formGroup]="autoPartForm" >
      
      <!-- Header del sidenav -->

      <div class="flex items-center justify-between -mt-3 -ml-4">
        <mat-icon
            class="icon-size-7 text-current"
            [svgIcon]="'heroicons_solid:cog'">
        </mat-icon>
        <div class="ml-3 text-2xl font-semibold tracking-tight">
          {{sideTittle}} <!-- Titulo del sidenav --> 
        </div> 
        <button
            class="ml-auto"
            mat-icon-button
            (click)="toggleDrawer(false)">
            <mat-icon class="text-current" [svgIcon]="'heroicons_outline:x'"> </mat-icon>
        </button>
      </div>
      <!-- Body del sidenav -->

        <mat-divider class="mt-6 mb-8"></mat-divider>

        <!-- Botones (Sumar repuesto, Restar repuesto) -->

        <ng-container *ngIf="mode()"> <!-- Esto es para que se vean los botones en una sola linea -->
          <button
              class="ml-3"
              mat-flat-button
              [color]="'primary'">
              <span class="ml-2 mr-1">Agregar 1</span>
          </button>

          <br>

          <button
              class="ml-3"
              mat-flat-button
              [color]="'warn'">
              <span class="ml-2 mr-1">Restar 1</span>
          </button>

          <br>
          <!-- drawer -->
          <mat-form-field class="fuse-mat-bold fuse-mat-dense fuse-mat-rounded">
            <mat-label>Stock</mat-label>
            <input matInput type="text" value = "10" readonly>
          </mat-form-field>

          <mat-divider class="mt-6 mb-8"></mat-divider>

        </ng-container>

        <!-- Fin Botones -->

        <!-- name -->
        <mat-form-field class="fuse-mat-bold fuse-mat-dense fuse-mat-rounded">
          <mat-label>Marca del repuesto</mat-label>
          <mat-select [(value)]="selectedmarcaRepuesto">
            <mat-option></mat-option>
            <mat-option [value]="option.value" *ngFor="let option of marcaRepuesto">{{ option.viewValue }}</mat-option>
          </mat-select>
        </mat-form-field>


        <!-- model -->
        <mat-form-field class="fuse-mat-bold fuse-mat-dense fuse-mat-rounded">
          <mat-label>Modelo del repuesto</mat-label>
          <input matInput type="text" placeholder="ME7.4.9">
        </mat-form-field>

        <!-- carName -->
        <mat-form-field class="fuse-mat-bold fuse-mat-dense fuse-mat-rounded">
          <mat-label>Marca de auto</mat-label>
          <mat-select [(value)]="selectedmarcaAuto">
            <mat-option></mat-option>
            <mat-option [value]="option.value" *ngFor="let option of marcaAuto">{{ option.viewValue }}</mat-option>
          </mat-select>
        </mat-form-field>

        <!-- drawer -->
        <mat-form-field class="fuse-mat-bold fuse-mat-dense fuse-mat-rounded">
          <mat-label>Cajon</mat-label>
          <input matInput type="text" placeholder="1">
        </mat-form-field>
        
        <!-- description -->
        <mat-form-field class="fuse-mat-bold fuse-mat-dense fuse-mat-rounded">
          <mat-label>Descripcion</mat-label>
          <input matInput #message maxlength="256" placeholder="Ej: Peugeot 206/207 Motor 1.4 8v o 1.6 16v">
          <mat-hint>
            {{message.value.length}} / 256 <!-- Esto es para que se vea el contador de caracteres -->
          </mat-hint>
        </mat-form-field>

        <button mat-raised-button>Subir imagen</button>

        <br>

        <div mat-dialog-actions [align]="'end'">
          <button mat-raised-button color="warn" mat-dialog-close (click)="toggleDrawer(false)">Cancelar</button>
          <button mat-raised-button color="primary" cdkFocusInitial (click)="saveAutoPart()">Guardar</button>
        </div>

      </form>
  </fuse-drawer>

  <!-- Esto es lo de la tabla y los botones -->
  <div class="flex-auto p-6 sm:p-10">

      <!-- Header -->
    <div class="flex flex-col sm:flex-row items-start sm:items-center sm:justify-between py-8 px-6 md:px-8">
      <!-- Title -->
      <div>
        <div class="text-4xl font-extrabold tracking-tight leading-none">Repuestos</div>
        <div class="ml-0.5 font-medium text-secondary"></div>
      </div>
      <!-- Actions -->
      <div class="mt-4 sm:mt-0">
        <!-- Add autopart button -->
        <button
            class="ml-3"
            mat-flat-button
            [color]="'primary'"
            (click)="toggleDrawer(false)"
            [disabled]="false">
            
            <span class="ml-2 mr-1">Agregar un repuesto</span>
        </button>
      </div>
    </div>

    <!-- Tabla de repuestos  -->

    <mat-form-field>
      <input matInput (keyup)="applyFilter($event)" placeholder="Inyectores" #input>
    </mat-form-field>
    
    <div class="mat-elevation-z8">
      <table mat-table [dataSource]="dataSource" matSort>
    
        <!-- ID Column -->
        <ng-container matColumnDef="id">
          <th mat-header-cell *matHeaderCellDef>ID</th>
          <td mat-cell *matCellDef="let row"> {{row.id}} </td>
        </ng-container>

        <!-- Name Column -->
        <ng-container matColumnDef="name">
          <th mat-header-cell *matHeaderCellDef>Marca</th>
          <td mat-cell *matCellDef="let row"> {{row.partBrand}} </td>
        </ng-container>
    
        <!-- Model Column -->
        <ng-container matColumnDef="model">
          <th mat-header-cell *matHeaderCellDef>Modelo</th>
          <td mat-cell *matCellDef="let row"> {{row.modelPart}} </td>
        </ng-container>
    
        <!-- Car Name Column -->
        <ng-container matColumnDef="carName">
          <th mat-header-cell *matHeaderCellDef>Marca de auto</th>
          <td mat-cell *matCellDef="let row"> {{row.carBrand}} </td>
        </ng-container>

        <!-- Drawer Column -->
        <ng-container matColumnDef="drawer">
          <th mat-header-cell *matHeaderCellDef>Cajon</th>
          <td mat-cell *matCellDef="let row"> {{row.drawer}} </td>
        </ng-container>

        <!-- Stock Column -->
        <ng-container matColumnDef="stock">
          <th mat-header-cell *matHeaderCellDef>Stock</th>
          <td mat-cell *matCellDef="let row"> {{row.stock}} </td>
        </ng-container>
    
        <!-- Description Column -->
        <ng-container matColumnDef="description">
          <th mat-header-cell *matHeaderCellDef>Descripcion</th>
          <td mat-cell *matCellDef="let row"> 
            <button mat-icon-button (click)="viewDescription(row)">
              <i class="fa-solid fa-eye"></i>
            </button>
          </td>
        </ng-container>

        <!-- Image Column -->
        <ng-container matColumnDef="image">
          <th mat-header-cell *matHeaderCellDef>Foto</th>
          <td mat-cell *matCellDef="let row"> 

          <button mat-icon-button (click)="viewImage('https://http2.mlstatic.com/D_NQ_NP_656507-MLA44939549084_022021-O.webp')">
            <i class="fa-solid fa-eye"></i>
          </button>
        
        </ng-container>

        <!-- Action Column -->
        <ng-container matColumnDef="actions">
          <th mat-header-cell *matHeaderCellDef>Editar</th>
          <td mat-cell *matCellDef="let row"> 

            <button mat-icon-button (click)="edit(row)" color = "primary">
              <i class="fa-sharp fa-solid fa-pen-to-square"></i>
            </button>
            
          </td>
        </ng-container>
    
        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
    
        <!-- Row shown when there is no matching data. -->
        <tr class="mat-row" *matNoDataRow>
          <td class="mat-cell" colspan="4">No se encontro ningun repuesto que coincida con "{{input.value}}"</td>
        </tr>
      </table>
    
      <mat-paginator [pageSizeOptions]="[5, 10, 25, 100]" aria-label="Select page of users"></mat-paginator>
    </div>
  </div>
</div>

